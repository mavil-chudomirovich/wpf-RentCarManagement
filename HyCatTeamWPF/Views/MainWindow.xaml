<Window x:Class="HyCatTeamWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="GreenWheel"
        Height="900" Width="1600"
        WindowStyle="None"
        Background="#F1F5F3"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>

        <!-- Shadow -->
        <DropShadowEffect x:Key="CardShadow"
                          BlurRadius="10"
                          ShadowDepth="3"
                          Color="#000000"
                          Opacity="0.15" />

        <!-- ================== SIDEBAR TOGGLE BUTTON STYLE ================== -->
        <Style x:Key="SidebarItem" TargetType="ToggleButton">
            <Setter Property="Foreground" Value="#ECFDF5" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Margin" Value="8 4" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Margin="2"
                                Padding="10 6">

                            <ContentPresenter VerticalAlignment="Center" />
                        </Border>

                        <ControlTemplate.Triggers>
                            <!-- Hover -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#0C6B60" />
                            </Trigger>

                            <!-- Selected -->
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#0FA827" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Icon Button -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Width" Value="42" />
            <Setter Property="Height" Value="42" />
            <Setter Property="Margin" Value="6" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- mac buttons -->
        <Style x:Key="MacBtn" TargetType="Button">
            <Setter Property="Width" Value="14" />
            <Setter Property="Height" Value="14" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Ellipse Fill="{TemplateBinding Background}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Background" Value="#0F766E" />
            <Setter Property="Height" Value="42" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Margin" Value="0 12 0 0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="8" Padding="10">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- ROOT -->
    <Grid>

        <!-- MAIN WRAPPER -->
        <Border Background="White" CornerRadius="20" Margin="16" Effect="{StaticResource CardShadow}">
            <Grid>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="240" x:Name="SidebarColumn" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- ========================================================= -->
                <!-- ===============    SIDEBAR (FIXED CLIP)    ============= -->
                <!-- ========================================================= -->
                <Grid>

                    <!-- ✨ FIX LỖI TRÀN KHI RESIZE -->

                    <Border Background="#0F766E" CornerRadius="20,0,0,20">
                        <Grid>

                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- MENU -->
                            <StackPanel Margin="0 20">

                                <!-- HOME BUTTON -->

                                <!-- HOME BUTTON -->
                                <TextBlock Text="🚗  GreenWheel"
                                           Foreground="White"
                                           FontSize="22"
                                           FontWeight="Bold" Width="172" />

                                <!-- HOME BUTTON -->
                                <ToggleButton x:Name="sidebarHome"
                                              Style="{StaticResource SidebarItem}"
                                              IsChecked="True"
                                              Click="SidebarHome_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🏠" FontSize="18" Margin="0 0 8 0" />
                                        <TextBlock Text="Home" />
                                    </StackPanel>
                                </ToggleButton>

                                <!-- RENTAL BOOKING -->
                                <ToggleButton x:Name="sidebarBooking"
                                              Style="{StaticResource SidebarItem}"
                                              Click="SidebarBooking_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📄" FontSize="18" Margin="0 0 8 0" />
                                        <TextBlock Text="Rental Booking" />
                                    </StackPanel>
                                </ToggleButton>
                            </StackPanel>

                            <!-- USER + LOGOUT -->
                            <StackPanel Grid.Row="1" Margin="0 0 0 20">

                                <Border CornerRadius="10"
                                        Background="#0C6B60"
                                        Margin="20">
                                    <StackPanel Orientation="Horizontal" Margin="10">

                                        <Border Width="42" Height="42" CornerRadius="21"
                                                Background="#E0E6E3" Margin="0 0 10 0">
                                            <Grid>
                                                <Image x:Name="ImgAvatar"
                                                       Stretch="UniformToFill"
                                                       Visibility="Collapsed">
                                                    <Image.Clip>
                                                        <EllipseGeometry Center="21,21" RadiusX="21" RadiusY="21" />
                                                    </Image.Clip>
                                                </Image>

                                                <TextBlock x:Name="TxtAvatarLetter"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           FontSize="18"
                                                           FontWeight="Bold"
                                                           Foreground="#0F766E" />
                                            </Grid>
                                        </Border>

                                        <StackPanel>
                                            <TextBlock x:Name="TxtFullName"
                                                       Foreground="White"
                                                       FontWeight="Bold"
                                                       FontSize="15" />

                                            <Border x:Name="RoleBadge"
                                                    Background="#2563EB"
                                                    CornerRadius="4"
                                                    Margin="0 4 0 0">
                                                <TextBlock x:Name="TxtRole"
                                                           Margin="4 1"
                                                           Foreground="White"
                                                           FontSize="12"
                                                           FontWeight="SemiBold" />
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Button Content="Logout"
                                        Width="150"
                                        Height="42"
                                        Background="#B91C1C"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Style="{StaticResource IconButton}"
                                        FontWeight="SemiBold"
                                        HorizontalContentAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        Margin="20 0"
                                        Click="Button_Click_2" />
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
                <!-- =========== END FIX SIDEBAR ============= -->

                <!-- =========================== MAIN CONTENT =========================== -->
                <Grid Grid.Column="1" Background="#F9FFFB">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="60" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- TOP BAR -->
                    <Grid Background="White" Effect="{StaticResource CardShadow}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="200" />
                        </Grid.ColumnDefinitions>

                        <Button x:Name="BtnToggleSidebar"
                                Content="☰"
                                FontSize="20"
                                Background="Transparent"
                                BorderThickness="0"
                                Click="BtnToggleSidebar_Click" />

                        <TextBlock
                                   Name="TxtWindowTitle"
                                   Grid.Column="1"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#0F766E"
                                   VerticalAlignment="Center"
                                   Margin="10 0 0 0" />

                        <!-- GROUPED RIGHT BUTTONS -->
                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="2"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Margin="0 0 20 0">

                            <Button Background="#FFBD2E" Style="{StaticResource MacBtn}" Click="MinimizeApp_Click" />
                            <Button Background="#28C840" Style="{StaticResource MacBtn}" Margin="10 0" Click="MaximizeApp_Click" />
                            <Button Background="#FF5F57" Style="{StaticResource MacBtn}" Click="CloseApp_Click" />
                        </StackPanel>
                    </Grid>

                    <!-- BODY -->
                    <ScrollViewer Grid.Row="1">
                        <StackPanel Margin="30">

                            <!-- FILTER CARD -->
                            <Border Background="White"
                                    CornerRadius="14"
                                    Effect="{StaticResource CardShadow}"
                                    Padding="20"
                                    x:Name="mainBorder"
                                    Margin="0 0 0 20">

                                <Grid Margin="0 10 0 0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="230" />
                                        <ColumnDefinition Width="230" />
                                        <ColumnDefinition Width="230" />
                                        <ColumnDefinition Width="160" />
                                        <ColumnDefinition Width="160" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Station" FontWeight="Bold" />
                                        <ComboBox x:Name="CboStation"
                                                  Margin="0 6 0 0"
                                                  Background="#EEF2F4"
                                                  Height="35"
                                                  DisplayMemberPath="Name"
                                                  SelectedValuePath="Id" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Start Date" FontWeight="Bold" />
                                        <DatePicker x:Name="DateStart"
                                                    Margin="0 6 0 0"
                                                    Background="#EEF2F4"
                                                    Height="35" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="End Date" FontWeight="Bold" />
                                        <DatePicker x:Name="DateEnd"
                                                    Margin="0 6 0 0"
                                                    Background="#EEF2F4"
                                                    Height="35" />
                                    </StackPanel>

                                    <Button Grid.Column="3"
                                            Content="Search"
                                            Style="{StaticResource PrimaryButton}"
                                            VerticalAlignment="Bottom"
                                            Click="Button_Click"
                                            Grid.ColumnSpan="2"
                                            Margin="60,0,100,0" />

                                    <Button Grid.Column="4"
                                            Content="Rent Vehicle"
                                            Style="{StaticResource PrimaryButton}"
                                            VerticalAlignment="Bottom"
                                            Click="Button_Click_1"
                                            Margin="120,0,-120,0" />
                                </Grid>
                            </Border>

                            <TextBlock Text="Available Vehicles"
                                       x:Name="availableVehicles"
                                       FontWeight="Bold"
                                       FontSize="18"
                                       Margin="0 20 0 10" />

                            <WrapPanel x:Name="VehiclePanel" />
                            <Button x:Name="BtnReload"
                             Content="Reload"
                             Margin="18"
                             HorizontalAlignment="Right"
                             Style="{StaticResource PrimaryButton}"
                             Width="150"
                             Click="reload_Click" />
                            <StackPanel x:Name="ContractPanel" />
                            <TextBlock Text="Rental Bookings"
                                       x:Name="contractTitle"
                                       FontWeight="Bold"
                                       FontSize="18"
                                       Margin="0 20 0 10" />
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>